<% if @user %>
  <% if flash[:points] %>
    <aside class="notification">
      Scored <%= flash[:points] %> points!
    </aside>
  <% end %>
  <% if flash[:transfer] %>
    <aside class="notification">
      Transferred <%= flash[:transfer][:points] %> points to <%= flash[:transfer][:to] %>.
    </aside>
  <% end %>
  <% if flash[:error] %>
    <% if flash[:error] === :forbidden_click %>
    <aside class="error">
      You aren't allowed to click right now.
    </aside>
    <% end %>
  <% end %>
  <h2>Hey, <%= @user.name %>. You have <%= @user.points %> points.</h2>
  <% if @user.can_click? %>
    <a href="/create-points">Click here to GET points!</a>
  <% else %>
    <h3>You can click again in <%= @user.next_click_allowed_words %>.</h3>
  <% end %>
  <h2>Leaderboard</h2>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th class="numeric">Points</th>
        <th class="numeric">Clicks</th>
        <th>Last click</th>
        <th>Can click</th>
        <th>Transfer points</th>
        <th class="numeric">Sent xfers</th>
      </tr>
    </thead>
    <tbody>
      <% @users.each do |user| %>
        <tr>
          <td><%= user.name %></td>
          <td class="numeric"><%= user.points_delimited %></td>
          <td class="numeric"><%= user.clicks.length %></td>
          <td><%= user.last_click_time_in_words %></td>
          <td>
            <% if user.can_click? %>
              now
            <% else %>
              in <%= user.next_click_allowed_words %>
            <% end %>
          </td>
          <td>
            <a href="/transfer-points/<%= user.slug %>/100">100</a>
            <a href="/transfer-points/<%= user.slug %>/250">250</a>
            <a href="/transfer-points/<%= user.slug %>/500">500</a>
            <a href="/transfer-points/<%= user.slug %>/1000">1k</a>
          </td>
          <td class="numeric"><%= user.transfers_from.count %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <h2>Please log in to play!</h2>
  <p>If you don't know how to log in, slack Graham for access.</p>
<% end %>